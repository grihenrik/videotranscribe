<!DOCTYPE html>
<html>
<head>
    <title>Simple Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-container { max-width: 500px; margin: 0 auto; }
        input, button { padding: 10px; margin: 10px 0; width: 100%; }
        button { background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="form-container">
        <h1>YouTube Transcription Tool - Test Page</h1>
        <form id="transcriptionForm">
            <input type="url" id="youtubeUrl" placeholder="YouTube URL" required>
            <button type="submit" id="transcribeBtn">Transcribe Video</button>
        </form>
        <div id="results" style="margin-top: 20px;">
            <p>Status: <span id="status">Ready</span></p>
        </div>
    </div>
    
    <script>
        console.log('Test page loaded!');
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ready!');
            
            const form = document.getElementById('transcriptionForm');
            const button = document.getElementById('transcribeBtn');
            const status = document.getElementById('status');
            
            console.log('Form:', form);
            console.log('Button:', button);
            
            if (form && button) {
                status.textContent = 'Form found and ready!';
                
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const url = document.getElementById('youtubeUrl').value;
                    
                    if (!url) {
                        status.textContent = 'Please enter a URL';
                        return;
                    }
                    
                    status.textContent = 'Processing...';
                    button.disabled = true;
                    
                    try {
                        const response = await fetch('/api/transcribe', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                url: url,
                                mode: 'auto',
                                lang: 'en'
                            })
                        });
                        
                        const result = await response.json();
                        console.log('API Response:', result);
                        
                        if (result.job_id) {
                            status.innerHTML = `Job created: ${result.job_id}<br>
                                <a href="${result.download_links.txt}" target="_blank">Download TXT</a> | 
                                <a href="${result.download_links.srt}" target="_blank">Download SRT</a>`;
                        } else {
                            status.textContent = 'Error: ' + (result.error || 'Unknown error');
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        status.textContent = 'Network error: ' + error.message;
                    } finally {
                        button.disabled = false;
                    }
                });
            } else {
                status.textContent = 'ERROR: Form elements not found!';
            }
        });
    </script>
</body>
</html>